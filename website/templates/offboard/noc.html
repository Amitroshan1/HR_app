{% extends "employee/E_homeBase.html" %}
{% block title %}Submit NOC{% endblock %}
{% block content %}

{% with messages = get_flashed_messages(with_categories=true) %}
{% if messages %}
{% for category, msg in messages %}
<div class="alert alert-{{ category }}"><strong>{{ msg }}</strong></div>
{% endfor %}
{% endif %}
{% endwith %}


<div class="container">
    <h2 class="centered-heading">Submit NOC</h2>

    <form class=method="POST" class="custom-resignation-form">
        {{ form.hidden_tag() }}

        <div class="form-group">
            {{ form.noc_form_date.label(class="form-label") }}
            {{ form.noc_form_date(class="form-control", min=today, max=today) }}
        </div>

        <div class="form-group mt-3">
            <label class="form-label">Select Department</label><br>
            {% for value, label in form.emp_type.choices %}
            <div class="form-check">
                <input class="form-check-input" type="checkbox" name="{{ form.emp_type.name }}" value="{{ value }}"
                    id="{{ value }}">
                <label class="form-check-label" for="{{ value }}">{{ label }}</label>
            </div>
            {% endfor %}
        </div>

        <div class="mt-4 d-flex gap-2 flex-wrap">
            {{ form.sent_email(class="btn btn-success",
            onclick="return confirm('Are you sure you want to submit NOC?');") }}

            {% if uploaded_nocs %}
            {% for noc in uploaded_nocs %}
            {% if noc.emp_type_uploader == "Human Resource" %}
            <a href="{{ url_for('offboard.download_noc', file_id=noc.id) }}" class="btn btn-outline-primary">Download HR
                NOC</a>
            {% elif noc.emp_type_uploader == "Accounts" %}
            <a href="{{ url_for('offboard.download_noc', file_id=noc.id) }}" class="btn btn-outline-warning">Download
                Accounts NOC</a>
            {% elif noc.emp_type_uploader == "IT" %}
            <a href="{{ url_for('offboard.download_noc', file_id=noc.id) }}" class="btn btn-outline-info">Download IT
                NOC</a>
            {% endif %}
            {% endfor %}
            {% endif %}
        </div>
    </form>


</div>

{% endblock %}