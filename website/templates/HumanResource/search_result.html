<!-- templates/search_results.html -->
{% extends "HumanResource/hr_base.html" %}
{% block title %}Search Results{% endblock %}
{% block content %}

<div class="secontainer">
    {% with errors = get_flashed_messages(category_filter=["error","success"]) %}
    {% if errors %}
        <div class="alert-danger">
            <ul>
                {%- for msg in errors %}
                <a class="close" href="/search">{{ msg }}...X</a>
                {% endfor -%}
            </ul>
        </div>
    {% endif %}
    {% endwith %}

    <h2 class="centered-heading"> Circle: {{ circle | upper }} and Employee Type: {{ emp_type | capitalize }}</h2>
    {% if admins %}
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Circle</th>
                    <th>Employee Type</th>
                </tr>
            </thead>
            <tbody>
                {% for admin in admins %}
                    <tr>
                        <td>{{ admin.first_name }}</td>
                        <td>{{ admin.email }}</td>
                        <td>{{ circle }}</td>
                        <td>{{ emp_type }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p>No matching entries found.</p>
    {% endif %}
    <a href="{{ url_for('hr.search') }}" class="btn btn-primary search">Back to Search</a><br>

<a href="#" id="toggleMonthFormHr" class="btn mt-3"
   style="background-color:#28a745;color:#fff;padding:8px 16px;border-radius:5px;text-decoration:none;">
   ðŸ“¥ Download HR Attendance Excel
</a>

<div id="monthFormHr" class="mt-3" style="display:none;background:#f8f9fa;padding:15px;border-radius:8px;">
  <form method="get" action="{{ url_for('hr.download_excel_hr') }}">
    <div class="form-group">
      <label for="month_hr" style="font-weight:600;">Select Month:</label>
      <input type="month" id="month_hr" name="month" class="form-control"
             value="{{ now().strftime('%Y-%m') }}" required>
    </div>
    <div class="mt-2">
      <button type="submit" class="btn" style="background:#218838;color:#fff;padding:6px 16px;border-radius:5px;">
        Download
      </button>
      <button type="button" id="cancelFormHr" class="btn btn-secondary" style="margin-left:8px;">Cancel</button>
    </div>
  </form>
</div>





</div>

<div class="container">
    <form method="POST" action="{{ url_for('hr.view_details') }}">
        {{ form.hidden_tag() }}
        <div class="form-group">
            <label for="user">Select User</label>
            {{ form.user(class="form-control") }}
        </div>
        <div class="form-group">
            <label for="detail_type">Select Detail Type</label>
            {{ form.detail_type(class="form-control") }}
        </div>
        <button type="submit" class="btn btn-primary">{{ form.submit.label }}</button>
    </form>
</div>


<script>
document.addEventListener("DOMContentLoaded", function(){
  const toggleBtn = document.getElementById("toggleMonthFormHr");
  const formBox = document.getElementById("monthFormHr");
  const cancelBtn = document.getElementById("cancelFormHr");
  toggleBtn.addEventListener("click", (e)=>{ e.preventDefault();
    formBox.style.display = formBox.style.display === "none" ? "block" : "none";
    toggleBtn.innerHTML = formBox.style.display === "none"
      ? "ðŸ“¥ Download HR Attendance Excel"
      : "ðŸ”½ Hide Month Selector";
  });
  cancelBtn.addEventListener("click", ()=>{
    formBox.style.display = "none";
    toggleBtn.innerHTML = "ðŸ“¥ Download HR Attendance Excel";
  });
});
</script>


{% endblock %}
