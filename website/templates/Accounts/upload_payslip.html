{% extends "Accounts/Acc_base.html" %}
{% block title %}Bulk Payslip{% endblock %}
{% block content %}

<h2 style="text-align:center; margin-top:20px;">ðŸ“‘ Upload & Send Payslips</h2>

<!-- Flash messages -->
{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    <div style="margin: 20px 0;">
      {% for category, message in messages %}
        <div >
          {{ message }}
        </div>
      {% endfor %}
    </div>
  {% endif %}
{% endwith %}

<form method="POST" enctype="multipart/form-data" style="max-width:600px; margin:0 auto; border:1px solid #ddd; padding:20px;">
  {{ form.hidden_tag() }}

  <!-- Month -->
  <div style="margin-bottom:15px;">
    <label>{{ form.month.label }}</label><br>
    {{ form.month }}
    {% for error in form.month.errors %}
      <div style="color:red; font-size:12px;">{{ error }}</div>
    {% endfor %}
  </div>

  <!-- Year -->
  <div style="margin-bottom:15px;">
    <label>{{ form.year.label }}</label><br>
    {{ form.year }}
    {% for error in form.year.errors %}
      <div style="color:red; font-size:12px;">{{ error }}</div>
    {% endfor %}
  </div>

  <!-- Upload multiple files -->
  <div style="margin-bottom:15px;">
    <label>{{ form.payslip_files.label }}</label><br>
    {{ form.payslip_files(multiple=true) }}
    <p style="font-size:12px; color:#555;">You can select multiple PDF files at once.</p>
    <div id="file-list" style="margin-top:5px; font-size:12px; color:#333;">No files selected</div>
    {% for error in form.payslip_files.errors %}
      <div style="color:red; font-size:12px;">{{ error }}</div>
    {% endfor %}
  </div>

  <!-- Submit -->
  <div style="text-align:center; margin-top:20px;">
    <button type="submit" style="padding:8px 15px; background:#007BFF; color:#fff; border:none; cursor:pointer;">
      Upload & Send
    </button>
    <a href="{{ url_for('Accounts.Acc_dashboard') }}" style="padding:8px 15px; background:#ccc; color:#000; text-decoration:none; margin-left:10px;">
      Cancel
    </a>
  </div>
</form>

<script>
  // Show selected file names
  document.addEventListener("DOMContentLoaded", () => {
    const input = document.querySelector("input[type=file]");
    const fileList = document.getElementById("file-list");

    input.addEventListener("change", () => {
      if (input.files.length > 0) {
        fileList.textContent = Array.from(input.files).map(f => f.name).join(", ");
      } else {
        fileList.textContent = "No files selected";
      }
    });
  });
</script>

{% endblock %}
